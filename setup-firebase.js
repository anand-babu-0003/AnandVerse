#!/usr/bin/env node

/**
 * Firebase Setup Helper Script
 * This script helps you set up Firebase environment variables
 */

const fs = require('fs');
const path = require('path');
const readline = require('readline');

const rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout
});

const question = (query) => new Promise((resolve) => rl.question(query, resolve));

async function setupFirebase() {
  console.log('üî• Firebase Setup Helper');
  console.log('========================\n');
  
  console.log('This script will help you set up Firebase environment variables.');
  console.log('You can find these values in your Firebase Console:\n');
  console.log('1. Go to https://console.firebase.google.com/');
  console.log('2. Select your project');
  console.log('3. Click ‚öôÔ∏è ‚Üí Project Settings');
  console.log('4. Scroll to "Your apps" ‚Üí Click web app icon </>');
  console.log('5. Copy the configuration values\n');

  try {
    const apiKey = await question('Enter your Firebase API Key: ');
    const authDomain = await question('Enter your Auth Domain (project-id.firebaseapp.com): ');
    const projectId = await question('Enter your Project ID: ');
    const storageBucket = await question('Enter your Storage Bucket (project-id.appspot.com): ');
    const messagingSenderId = await question('Enter your Messaging Sender ID: ');
    const appId = await question('Enter your App ID: ');

    // Validate inputs
    if (!apiKey || !authDomain || !projectId || !storageBucket || !messagingSenderId || !appId) {
      console.log('\n‚ùå Error: All fields are required!');
      process.exit(1);
    }

    // Create .env.local content
    const envContent = `# Firebase Configuration
# Generated by setup-firebase.js on ${new Date().toISOString()}

NEXT_PUBLIC_FIREBASE_API_KEY=${apiKey}
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=${authDomain}
NEXT_PUBLIC_FIREBASE_PROJECT_ID=${projectId}
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=${storageBucket}
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=${messagingSenderId}
NEXT_PUBLIC_FIREBASE_APP_ID=${appId}

# Optional: Google Analytics
# NEXT_PUBLIC_GA_ID=your_ga_id

# Optional: Site Verification
# GOOGLE_SITE_VERIFICATION=your_verification_code
# YANDEX_VERIFICATION=your_yandex_code
# YAHOO_VERIFICATION=your_yahoo_code
`;

    // Write to .env.local
    const envPath = path.join(process.cwd(), '.env.local');
    fs.writeFileSync(envPath, envContent);

    console.log('\n‚úÖ Successfully created .env.local file!');
    console.log('\nüìã Next steps:');
    console.log('1. Restart your development server: npm run dev');
    console.log('2. Visit http://localhost:3000/firebase-test to test the connection');
    console.log('3. Check http://localhost:3000/admin to see if data loads');
    
    console.log('\nüîß If you still have issues:');
    console.log('- Make sure Firestore is enabled in Firebase Console');
    console.log('- Check Firestore rules allow read access');
    console.log('- Verify your internet connection');

  } catch (error) {
    console.error('\n‚ùå Error:', error.message);
  } finally {
    rl.close();
  }
}

// Run the setup
setupFirebase();
